var I=function(){O.fillStyle="#DDD",O.fillRect(0,0,f,J)},A=function($,q,B,H,L){const K=$*B,M=q*B;if(L)O.fillStyle=L,O.fillRect(K+1,M+1,B-2,B-2);O.strokeStyle=H,O.strokeRect(K,M,B,B)},D=function($,q,B){A($,q,N*3,"#000",B);for(let H=0;H<3;H++)for(let L=0;L<3;L++)A($*3+L,q*3+H,N,"#AAA")},E=function($,q){if(Q[q][$]!==null){O.font="bold 60px Arial",O.textBaseline="middle",O.textAlign="center";const B=$*N+Math.floor(N*0.5),H=q*N+Math.floor(N*0.575);O.fillText(Q[q][$].toString(),B,H)}else{O.fillStyle="#000",O.font="16px Arial",O.textBaseline="top",O.textAlign="start";const B=W[q][$],H=Math.max(N-2,Math.floor(N*0.8)),L=Math.floor(H/3),K=Math.max(1,Math.floor(N*0.1)),M=$*N+K,p=q*N+K;for(let X=1;X<=9;X++){const G=B.includes(X)?X:null,w=(X-1)%3,k=Math.floor((X-1)/3),y=M+L*w,g=p+L*k;O.fillText(G!==null?G.toString():"",y,g)}}},Z=function(){for(let $=0;$<9;$++)for(let q=0;q<9;q++)E(q,$)},F=function(){I();for(let $=0;$<3;$++)for(let q=0;q<3;q++)D(q,$)},_=function($,q,B){const H=W[q][$].indexOf(B);if(H!==-1)W[q][$].splice(H,1)},V=function($,q,B){const H=Math.floor($/3)*3,L=Math.floor(q/3)*3;for(let K=0;K<9;K++)if(Q[K][q]===B||Q[$][K]===B)return!1;for(let K=H;K<H+3;K++)for(let M=L;M<L+3;M++)if(Q[K][M]===B)return!1;return!0},R=function($,q,B){if(!W[q][$].includes(B)&&V($,q,B))W[q][$].push(B)},C=function($,q,B){for(let K=0;K<9;K++)_(K,q,B),_($,K,B);const H=Math.floor($/3)*3,L=Math.floor(q/3)*3;for(let K=H;K<H+3;K++)for(let M=L;M<L+3;M++)_(K,M,B)},z=function($,q,B){for(let K=0;K<9;K++)R(K,q,B),R($,K,B);const H=Math.floor($/3)*3,L=Math.floor(q/3)*3;for(let K=H;K<H+3;K++)for(let M=L;M<L+3;M++)R(K,M,B)},P=function($,q,B,H){if(H==="add")C($,q,B);else z($,q,B)},h=function($,q){I(),F(),Z(),A($,q,N,"#000","#FFD700")},S=function($){if(!U)return;const[q,B]=U;if(T[B][q]!==null)return;if(Q[B][q]===$)Q[B][q]=null,P(q,B,$,"remove");else if(Q[B][q]!==null&&$!==null)return;else if(W[B][q].includes($))Q[B][q]=$,P(q,B,$,"add");Z(),E(q,B)},b=new WebSocket(`ws://${location.host}`);var Y=document.getElementById("sudokuCanvas"),O=Y.getContext("2d"),f=Y.width,J=Y.height,N=Math.round(Math.min(f,J)/9);b.onopen=()=>setInterval(()=>b.send("ping"),5000);b.onmessage=($)=>{if($.data!=="Well received")console.log($.data);if($.data==="reload")location.reload()};var W=[],Q=[],T=[];for(let $=0;$<9;$++)W[$]=Array(9).fill([]).map(()=>[1,2,3,4,5,6,7,8,9]),Q[$]=Array(9).fill(null),T[$]=Array(9).fill(null);var U=null;Y.addEventListener("mousemove",($)=>{$.stopPropagation();const{offsetX:q,offsetY:B}=$,H=Math.min(Math.floor(q/N),8),L=Math.min(Math.floor(B/N),8);if(U===null||U[0]!==H||U[1]!==L)U=[H,L],h(H,L)});Y.addEventListener("click",($)=>{const{offsetX:q,offsetY:B}=$,H=Math.min(Math.floor(q/N),8),L=Math.min(Math.floor(B/N),8);U=[H,L],h(H,L)});Y.addEventListener("mouseout",($)=>{$.stopPropagation(),U=null,F(),Z(),console.log("Cellule s\xE9lectionn\xE9e:",U)});document.addEventListener("keydown",($)=>{if($.key==="Backspace"&&U){const[B,H]=U;if(T[H][B]!==null)return;if(Q[H][B]!==null){const L=Q[H][B];if(typeof L==="number")P(B,H,L,"remove");Q[H][B]=null,E(B,H)}return}const q=Number($.key);if(q>=1&&q<=9)S(q)});F();Z();console.log("Frontend charg\xE9");
